From bcf19e4f35a843fd0a548b60200bb1bfb71b9a48 Mon Sep 17 00:00:00 2001
From: Harshesh Valera <harshesh.v@variscite.com>
Date: Tue, 16 Aug 2022 21:22:57 -0700
Subject: [PATCH 07/11] imx8mp_var_dart: Enable bluetooth wifi properties to be
 set

Signed-off-by: Harshesh Valera <harshesh.v@variscite.com>
Change-Id: Ib54bc74fdcde1effbf3e6ea8e3ec7cb0c74df397
---
 prebuilts/api/31.0/private/property.te | 22 ++++------------------
 private/property.te                    | 22 ++++------------------
 2 files changed, 8 insertions(+), 36 deletions(-)

diff --git a/prebuilts/api/31.0/private/property.te b/prebuilts/api/31.0/private/property.te
index 587cf5e2f..74d144459 100644
--- a/prebuilts/api/31.0/private/property.te
+++ b/prebuilts/api/31.0/private/property.te
@@ -167,6 +167,8 @@ compatible_property_only(`
     -nfc_prop
     -powerctl_prop
     -radio_prop
+    -wifi_prop
+    -bluetooth_prop
   }:property_service set;
 
   neverallow {
@@ -197,15 +199,6 @@ compatible_property_only(`
     radio_prop
   }:property_service set;
 
-  neverallow {
-    domain
-    -coredomain
-    -bluetooth
-    -hal_bluetooth_server
-  } {
-    bluetooth_prop
-  }:property_service set;
-
   neverallow {
     domain
     -coredomain
@@ -226,15 +219,6 @@ compatible_property_only(`
     exported_camera_prop
   }:property_service set;
 
-  neverallow {
-    domain
-    -coredomain
-    -hal_wifi_server
-    -wificond
-  } {
-    wifi_prop
-  }:property_service set;
-
   neverallow {
     domain
     -init
@@ -288,6 +272,7 @@ compatible_property_only(`
     -coredomain
     -bluetooth
     -hal_bluetooth_server
+    -vendor_init
   } {
     bluetooth_prop
   }:file no_rw_file_perms;
@@ -297,6 +282,7 @@ compatible_property_only(`
     -coredomain
     -hal_wifi_server
     -wificond
+    -vendor_init
   } {
     wifi_prop
   }:file no_rw_file_perms;
diff --git a/private/property.te b/private/property.te
index 587cf5e2f..74d144459 100644
--- a/private/property.te
+++ b/private/property.te
@@ -167,6 +167,8 @@ compatible_property_only(`
     -nfc_prop
     -powerctl_prop
     -radio_prop
+    -wifi_prop
+    -bluetooth_prop
   }:property_service set;
 
   neverallow {
@@ -197,15 +199,6 @@ compatible_property_only(`
     radio_prop
   }:property_service set;
 
-  neverallow {
-    domain
-    -coredomain
-    -bluetooth
-    -hal_bluetooth_server
-  } {
-    bluetooth_prop
-  }:property_service set;
-
   neverallow {
     domain
     -coredomain
@@ -226,15 +219,6 @@ compatible_property_only(`
     exported_camera_prop
   }:property_service set;
 
-  neverallow {
-    domain
-    -coredomain
-    -hal_wifi_server
-    -wificond
-  } {
-    wifi_prop
-  }:property_service set;
-
   neverallow {
     domain
     -init
@@ -288,6 +272,7 @@ compatible_property_only(`
     -coredomain
     -bluetooth
     -hal_bluetooth_server
+    -vendor_init
   } {
     bluetooth_prop
   }:file no_rw_file_perms;
@@ -297,6 +282,7 @@ compatible_property_only(`
     -coredomain
     -hal_wifi_server
     -wificond
+    -vendor_init
   } {
     wifi_prop
   }:file no_rw_file_perms;
-- 
2.25.1

