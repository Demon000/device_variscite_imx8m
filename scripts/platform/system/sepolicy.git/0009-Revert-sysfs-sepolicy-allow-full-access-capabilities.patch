From 35b266a247eab251b70ce2d7229aa725cf0d673d Mon Sep 17 00:00:00 2001
From: Harshesh Valera <harshesh.v@variscite.com>
Date: Wed, 21 Sep 2022 21:53:43 -0700
Subject: [PATCH 09/11] Revert "sysfs sepolicy: allow full access capabilities"

This reverts commit 2960c2dbb98200d3430c20ff673b8d093a7b596e.
---
 prebuilts/api/31.0/public/domain.te | 1 +
 public/domain.te                    | 1 +
 2 files changed, 2 insertions(+)

diff --git a/prebuilts/api/31.0/public/domain.te b/prebuilts/api/31.0/public/domain.te
index b4a58fc5d..c9c8ef5bd 100644
--- a/prebuilts/api/31.0/public/domain.te
+++ b/prebuilts/api/31.0/public/domain.te
@@ -1318,6 +1318,7 @@ neverallow * same_process_hwservice:hwservice_manager add;
 # to do so should never be granted.
 neverallow domain {
   proc_type
+  sysfs_type
 }:dir { add_name create link remove_name rename reparent rmdir write };
 
 # cgroupfs directories can be created, but not files within them.
diff --git a/public/domain.te b/public/domain.te
index b4a58fc5d..c9c8ef5bd 100644
--- a/public/domain.te
+++ b/public/domain.te
@@ -1318,6 +1318,7 @@ neverallow * same_process_hwservice:hwservice_manager add;
 # to do so should never be granted.
 neverallow domain {
   proc_type
+  sysfs_type
 }:dir { add_name create link remove_name rename reparent rmdir write };
 
 # cgroupfs directories can be created, but not files within them.
-- 
2.25.1

